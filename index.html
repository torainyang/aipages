<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <title>AI Decks Portal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    :root {
      --bg-deep: #050a14;
      --bg-panel: #0b1728;
      --accent-blue: #2b78e4;
      --accent-blue-soft: rgba(43, 120, 228, 0.15);
      --accent-green: #10a37f;
      --text-main: #f5f7fa;
      --text-sub: #a8b3c7;
      --border-soft: rgba(255, 255, 255, 0.08);
      --card-radius: 18px;
      --shadow-soft: 0 18px 40px rgba(0, 0, 0, 0.55);
      --max-width: 1120px;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
                   "Segoe UI", Roboto, "PingFang SC", "Hiragino Sans GB",
                   "Microsoft YaHei", sans-serif;
      background: radial-gradient(circle at top, #122647 0, #050a14 45%, #02040a 100%);
      color: var(--text-main);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      padding: 32px 16px 40px;
    }

    .shell {
      width: 100%;
      max-width: var(--max-width);
    }

    header {
      margin-bottom: 24px;
    }

    .tagline {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(16, 163, 127, 0.3);
      background: radial-gradient(circle at 0 0, rgba(16, 163, 127, 0.25), transparent 60%);
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      color: var(--accent-green);
      margin-bottom: 12px;
    }

    .tag-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: var(--accent-green);
      box-shadow: 0 0 10px rgba(16, 163, 127, 0.9);
    }

    h1 {
      font-size: 26px;
      font-weight: 650;
      margin-bottom: 6px;
      letter-spacing: 0.02em;
    }

    .subtitle {
      font-size: 13px;
      color: var(--text-sub);
      max-width: 520px;
      line-height: 1.5;
    }

    .meta-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px 18px;
      margin-top: 14px;
      font-size: 11px;
      color: var(--text-sub);
    }

    .meta-pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(7, 16, 32, 0.9);
      border: 1px solid rgba(255, 255, 255, 0.06);
    }

    .meta-pill span {
      opacity: 0.8;
    }

    .meta-dot {
      width: 4px;
      height: 4px;
      border-radius: 999px;
      background: rgba(168, 179, 199, 0.7);
    }

    main {
      margin-top: 24px;
      background: linear-gradient(135deg, rgba(9, 26, 55, 0.96), rgba(4, 11, 26, 0.98));
      border-radius: 24px;
      border: 1px solid var(--border-soft);
      box-shadow: var(--shadow-soft);
      padding: 18px 18px 22px;
      position: relative;
      overflow: hidden;
    }

    .grid-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
      gap: 12px;
    }

    .grid-title {
      font-size: 13px;
      font-weight: 600;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: var(--text-sub);
    }

    .grid-title span {
      color: var(--accent-blue);
    }

    .status-pill {
      font-size: 11px;
      color: var(--accent-blue);
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(43, 120, 228, 0.45);
      background: radial-gradient(circle at 0 0, rgba(43, 120, 228, 0.28), transparent 60%);
      display: inline-flex;
      align-items: center;
      gap: 6px;
      white-space: nowrap;
    }

    .status-pulse {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: var(--accent-blue);
      box-shadow: 0 0 12px rgba(43, 120, 228, 0.9);
    }

    .deck-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: 14px;
      margin-top: 4px;
    }

    .deck-card {
      position: relative;
      border-radius: var(--card-radius);
      padding: 14px 14px 12px;
      background: radial-gradient(circle at top left, var(--accent-blue-soft), rgba(9, 18, 36, 0.95));
      border: 1px solid rgba(255, 255, 255, 0.04);
      cursor: pointer;
      text-decoration: none;
      color: var(--text-main);
      overflow: hidden;
      transition:
        transform 0.18s ease-out,
        box-shadow 0.18s ease-out,
        border-color 0.18s ease-out,
        background 0.18s ease-out;
    }

    .deck-card::before {
      content: "";
      position: absolute;
      inset: -20%;
      opacity: 0;
      background: radial-gradient(circle at top, rgba(43, 120, 228, 0.4), transparent 60%);
      transition: opacity 0.18s ease-out;
      pointer-events: none;
    }

    .deck-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 14px 26px rgba(0, 0, 0, 0.7);
      border-color: rgba(43, 120, 228, 0.7);
      background: radial-gradient(circle at top left, rgba(43, 120, 228, 0.35), rgba(6, 14, 30, 0.98));
    }

    .deck-card:hover::before {
      opacity: 0.8;
    }

    .deck-tag-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 10px;
      margin-bottom: 8px;
      color: var(--text-sub);
      opacity: 0.9;
    }

    .deck-tag {
      padding: 2px 8px;
      border-radius: 999px;
      background: rgba(2, 10, 26, 0.9);
      border: 1px solid rgba(164, 177, 206, 0.35);
    }

    .deck-title {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 6px;
      line-height: 1.35;
    }

    .deck-desc {
      font-size: 12px;
      color: var(--text-sub);
      line-height: 1.5;
      margin-bottom: 10px;
      min-height: 34px;
    }

    .deck-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 11px;
      color: var(--text-sub);
      opacity: 0.9;
    }

    .deck-link {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 11px;
      color: var(--accent-blue);
      text-decoration: none;
    }

    .deck-link-arrow {
      font-size: 13px;
      transform: translateY(0.5px);
    }

    .deck-meta {
      opacity: 0.85;
    }

    .empty-state, .error-state {
      font-size: 12px;
      color: var(--text-sub);
      margin-top: 10px;
      padding: 10px 12px;
      border-radius: 10px;
      background: rgba(3, 10, 24, 0.9);
      border: 1px dashed rgba(255, 255, 255, 0.12);
    }

    .error-state span {
      color: #ff8787;
    }

    .loading-row {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 12px;
      color: var(--text-sub);
      margin-top: 6px;
    }

    .spinner {
      width: 14px;
      height: 14px;
      border-radius: 50%;
      border: 2px solid rgba(168, 179, 199, 0.28);
      border-top-color: var(--accent-blue);
      animation: spin 0.9s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    @media (max-width: 640px) {
      body {
        padding: 20px 12px 28px;
      }

      main {
        padding: 16px 12px 20px;
      }

      h1 {
        font-size: 22px;
      }
    }
  </style>
</head>
<body>
  <div class="shell">
    <header>
      <div class="tagline">
        <span class="tag-dot"></span>
        <span>AI DECKS · LIVE PORTAL</span>
      </div>
      <h1>AI 组织与战略 Decks 中枢</h1>
      <p class="subtitle">
        自动汇总当前仓库下所有 HTML Deck 文件夹。新增一个子目录，即自动多一张卡片。
        适合集中管理 AI 组织转型、AGI 演进、人才蓝图等演示文档。
      </p>
      <div class="meta-row">
        <div class="meta-pill">
          <span>GitHub Pages</span>
          <span class="meta-dot"></span>
          <span>Auto Directory Index</span>
        </div>
        <div class="meta-pill">
          <span>Torain Internal Use</span>
          <span class="meta-dot"></span>
          <span>HTML · CSS · JS</span>
        </div>
      </div>
    </header>

    <main>
      <div class="grid-header">
        <div class="grid-title">
          ACTIVE <span>DECKS</span> OVERVIEW
        </div>
        <div class="status-pill">
          <span class="status-pulse"></span>
          <span id="status-label">Loading from GitHub…</span>
        </div>
      </div>

      <div class="loading-row" id="loading-row">
        <div class="spinner"></div>
        <div>正在从仓库读取目录结构，请稍候…</div>
      </div>

      <div class="deck-grid" id="deck-grid" style="display:none;"></div>

      <div class="empty-state" id="empty-state" style="display:none;">
        当前仓库根目录下未检测到可用的 Deck 文件夹。<br>
        请确认目录结构类似：<code>google-ai-reorg/index.html</code>、<code>agi-panorama-2030/index.html</code> 等。
      </div>

      <div class="error-state" id="error-state" style="display:none;">
        <span>GitHub API 调用失败。</span> 请检查：
        <ul style="margin-top:6px; padding-left:18px;">
          <li>仓库是否为 <strong>Public</strong>（公开）</li>
          <li>下面脚本中的 <code>GITHUB_OWNER</code> 和 <code>GITHUB_REPO</code> 是否填写正确</li>
          <li>是否已在 Settings → Pages 启用 GitHub Pages</li>
        </ul>
      </div>
    </main>
  </div>

  <script>
    // ============================
    // 需要你手动配置的两个参数
    // ============================
    const GITHUB_OWNER = "torainyang";  // TODO: 改成你的 GitHub 用户名
    const GITHUB_REPO  = "aipages";              // TODO: 改成你的仓库名

    // 如果所有 deck 目录都在仓库根目录下，保持空字符串即可
    // 如果你想放在子目录，比如 /decks/，则写成 "decks"
    const ROOT_PATH = ""; // 不要以 / 开头或结尾，空字符串表示根目录

    // 不希望在首页展示的文件夹
    const IGNORED_FOLDERS = [
      "assets",
      ".github",
      ".git",
      "Final_pages",
      "template-deck",
      "node_modules"
    ];

    const deckGridEl   = document.getElementById("deck-grid");
    const emptyStateEl = document.getElementById("empty-state");
    const errorStateEl = document.getElementById("error-state");
    const loadingRowEl = document.getElementById("loading-row");
    const statusLabel  = document.getElementById("status-label");

    function humanizeName(rawName) {
      // 例： "ai-org-transformation-2025" → "AI Org Transformation 2025"
      return rawName
        .replace(/[-_]+/g, " ")
        .split(" ")
        .filter(Boolean)
        .map((w) => w.charAt(0).toUpperCase() + w.slice(1))
        .join(" ");
    }

    function buildDeckHref(dirName) {
      if (!ROOT_PATH) {
        return `./${dirName}/`;
      }
      return `./${ROOT_PATH}/${dirName}/`;
    }

    async function fetchRepoRoot() {
      const apiPath = ROOT_PATH ? `contents/${encodeURIComponent(ROOT_PATH)}` : "contents";
      const url = `https://api.github.com/repos/${GITHUB_OWNER}/${GITHUB_REPO}/${apiPath}`;

      const res = await fetch(url, {
        headers: {
          "Accept": "application/vnd.github.v3+json"
        }
      });

      if (!res.ok) {
        throw new Error("GitHub API error: " + res.status);
      }
      return res.json();
    }

    function renderDecks(dirs) {
      deckGridEl.innerHTML = "";

      dirs.forEach((dir) => {
        const href = buildDeckHref(dir.name);
        const title = humanizeName(dir.name);

        const card = document.createElement("a");
        card.className = "deck-card";
        card.href = href;
        card.target = "_blank";
        card.rel = "noopener noreferrer";

        card.innerHTML = `
          <div class="deck-tag-row">
            <div class="deck-tag">HTML Deck</div>
            <div>${dir.name}</div>
          </div>
          <div class="deck-title">${title}</div>
          <div class="deck-desc">
            自动从仓库目录生成的入口。点击进入该主题的演示页面。
          </div>
          <div class="deck-footer">
            <div class="deck-meta">Folder · ${dir.name}</div>
            <div class="deck-link">
              <span>Open Deck</span>
              <span class="deck-link-arrow">↗</span>
            </div>
          </div>
        `;

        deckGridEl.appendChild(card);
      });
    }

    async function init() {
      try {
        const items = await fetchRepoRoot();

        const dirs = (items || [])
          .filter((item) => item.type === "dir")
          .filter((item) => !IGNORED_FOLDERS.includes(item.name))
          .sort((a, b) => a.name.localeCompare(b.name));

        loadingRowEl.style.display = "none";

        if (!dirs.length) {
          emptyStateEl.style.display = "block";
          statusLabel.textContent = "No active decks detected";
          return;
        }

        renderDecks(dirs);
        deckGridEl.style.display = "grid";
        statusLabel.textContent = `Active decks: ${dirs.length}`;
      } catch (err) {
        console.error(err);
        loadingRowEl.style.display = "none";
        errorStateEl.style.display = "block";
        statusLabel.textContent = "Error loading decks";
      }
    }

    init();
  </script>
</body>
</html>

